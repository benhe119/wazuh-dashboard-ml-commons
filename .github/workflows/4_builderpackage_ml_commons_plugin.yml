# ğŸ“ Based on: `4_builderprecompiled_base-dev-environment.yml`
#
# ğŸ“¦ Manual Build Workflow for Wazuh Dashboard ML Commons Plugin
#
# âš¡ Overview:
# This workflow builds and tests production-ready packages for Wazuh Dashboard ML Commons plugin,
# either manually or triggered by other workflows.
#
# ğŸš€ Key Features:
# - ğŸ–‡ï¸ Manual or Automated Builds: Supports manual execution or invocation from other workflows,
#   specifying any valid code reference (branch, tag, or commit SHA).
# - ğŸ—ï¸ Production-Ready Package Generation: Builds a production-ready package from the provided code reference.
# - ğŸŒ Reusable Build Environment: Reuses a preconfigured build environment, ensuring consistency and easier maintenance.
#

name: Build app package (on demand)

on:
  workflow_call:
    inputs:
      reference:
        required: true
        type: string
        description: Git reference (branch, tag, or commit SHA) to build from.
        default: '4.14.0'
  workflow_dispatch:
    inputs:
      reference:
        required: true
        type: string
        default: '4.14.0'
        description: Git reference (branch, tag, or commit SHA) to build from.

jobs:
  # Build an app package from the given source code reference.
  build:
    name: Build app package
    uses: ./.github/workflows/4_builderprecompiled_base-dev-environment.yml
    with:
      reference: ${{ inputs.reference }}
      command: 'yarn build'
      artifact_name: 'ml-commons-dashboards'
      artifact_path: './wazuh-dashboard-ml-commons/build'
    secrets: inherit
